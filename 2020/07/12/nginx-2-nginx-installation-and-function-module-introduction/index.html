<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Nginx安装和功能模块介绍 | 余思博客</title><meta name="keywords" content="nginx"><meta name="author" content="余思"><meta name="copyright" content="余思"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="写在前面本篇学习如何在CentOS7上安装Nginx，并在此基础上了解Nginx强大的功能模块、目录结构和文件等信息。 Nginx安装这里以Centos7系统为例，介绍如何在Linux系统上安装Nginx。 第一步，安装相应的依赖。依次执行如下命令： 12yum -y install pcre-develyum -y install openssl openssl-devel 第二步，下载Ngin">
<meta property="og:type" content="article">
<meta property="og:title" content="Nginx安装和功能模块介绍">
<meta property="og:url" content="http://envyzhan.asia/2020/07/12/nginx-2-nginx-installation-and-function-module-introduction/index.html">
<meta property="og:site_name" content="余思博客">
<meta property="og:description" content="写在前面本篇学习如何在CentOS7上安装Nginx，并在此基础上了解Nginx强大的功能模块、目录结构和文件等信息。 Nginx安装这里以Centos7系统为例，介绍如何在Linux系统上安装Nginx。 第一步，安装相应的依赖。依次执行如下命令： 12yum -y install pcre-develyum -y install openssl openssl-devel 第二步，下载Ngin">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png">
<meta property="article:published_time" content="2020-07-12T10:13:01.000Z">
<meta property="article:modified_time" content="2021-03-01T10:30:21.012Z">
<meta property="article:author" content="余思">
<meta property="article:tag" content="nginx">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://envyzhan.asia/2020/07/12/nginx-2-nginx-installation-and-function-module-introduction/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Nginx安装和功能模块介绍',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-03-01 18:30:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="余思博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">235</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 前端</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/html/"><i class="fa-fw fa fa-cog"></i><span> HTML/CSS</span></a></li><li><a class="site-page child" href="/categories/javascript/"><i class="fa-fw fa fa-cogs"></i><span> JavaScript</span></a></li><li><a class="site-page child" href="/categories/vuejs/"><i class="fa-fw fa fa-certificate"></i><span> Vue.js</span></a></li><li><a class="site-page child" href="/categories/flutter/"><i class="fa-fw fa fa-bullseye"></i><span> Flutter</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> Java</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/java/"><i class="fa-fw fa fa-book"></i><span> Java</span></a></li><li><a class="site-page child" href="/categories/ssm/"><i class="fa-fw fa fa-cube"></i><span> SSM</span></a></li><li><a class="site-page child" href="/categories/springboot/"><i class="fa-fw fa fa-cubes"></i><span> SpringBoot</span></a></li><li><a class="site-page child" href="/categories/springcloud/"><i class="fa-fw fa fa-cloud"></i><span> SpringCloud</span></a></li><li><a class="site-page child" href="/categories/springsecurity/"><i class="fa-fw fa fa-bullseye"></i><span> SpringSecurity</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 运维</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/pythonbase/"><i class="fa-fw fa fa-book"></i><span> Python</span></a></li><li><a class="site-page child" href="/categories/go/"><i class="fa-fw fa fa-google-plus"></i><span> Golang</span></a></li><li><a class="site-page child" href="/categories/devops/"><i class="fa-fw fa fa-road"></i><span> DevOps</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 中间件</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/mysql/"><i class="fa-fw fa fa-database"></i><span> MySQL</span></a></li><li><a class="site-page child" href="/categories/redis/"><i class="fa-fw fa fa-random"></i><span> Redis</span></a></li><li><a class="site-page child" href="/categories/other/"><i class="fa-fw fa fa-location-arrow"></i><span> 其他</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bell"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/datastructs/"><i class="fa-fw fa fa-plug"></i><span> 算法结构</span></a></li><li><a class="site-page child" href="/categories/tools/"><i class="fa-fw fa fa-hourglass"></i><span> 实用工具</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-address-book"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/onenote/"><i class="fa-fw fa fa-laptop"></i><span> 个人随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-comment"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">余思博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 前端</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/html/"><i class="fa-fw fa fa-cog"></i><span> HTML/CSS</span></a></li><li><a class="site-page child" href="/categories/javascript/"><i class="fa-fw fa fa-cogs"></i><span> JavaScript</span></a></li><li><a class="site-page child" href="/categories/vuejs/"><i class="fa-fw fa fa-certificate"></i><span> Vue.js</span></a></li><li><a class="site-page child" href="/categories/flutter/"><i class="fa-fw fa fa-bullseye"></i><span> Flutter</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> Java</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/java/"><i class="fa-fw fa fa-book"></i><span> Java</span></a></li><li><a class="site-page child" href="/categories/ssm/"><i class="fa-fw fa fa-cube"></i><span> SSM</span></a></li><li><a class="site-page child" href="/categories/springboot/"><i class="fa-fw fa fa-cubes"></i><span> SpringBoot</span></a></li><li><a class="site-page child" href="/categories/springcloud/"><i class="fa-fw fa fa-cloud"></i><span> SpringCloud</span></a></li><li><a class="site-page child" href="/categories/springsecurity/"><i class="fa-fw fa fa-bullseye"></i><span> SpringSecurity</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 运维</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/pythonbase/"><i class="fa-fw fa fa-book"></i><span> Python</span></a></li><li><a class="site-page child" href="/categories/go/"><i class="fa-fw fa fa-google-plus"></i><span> Golang</span></a></li><li><a class="site-page child" href="/categories/devops/"><i class="fa-fw fa fa-road"></i><span> DevOps</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 中间件</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/mysql/"><i class="fa-fw fa fa-database"></i><span> MySQL</span></a></li><li><a class="site-page child" href="/categories/redis/"><i class="fa-fw fa fa-random"></i><span> Redis</span></a></li><li><a class="site-page child" href="/categories/other/"><i class="fa-fw fa fa-location-arrow"></i><span> 其他</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bell"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/datastructs/"><i class="fa-fw fa fa-plug"></i><span> 算法结构</span></a></li><li><a class="site-page child" href="/categories/tools/"><i class="fa-fw fa fa-hourglass"></i><span> 实用工具</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-address-book"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/onenote/"><i class="fa-fw fa fa-laptop"></i><span> 个人随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-comment"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Nginx安装和功能模块介绍</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-07-12T10:13:01.000Z" title="发表于 2020-07-12 18:13:01">2020-07-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-01T10:30:21.012Z" title="更新于 2021-03-01 18:30:21">2021-03-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/nginx/">nginx</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>本篇学习如何在CentOS7上安装Nginx，并在此基础上了解Nginx强大的功能模块、目录结构和文件等信息。</p>
<h1 id="Nginx安装"><a href="#Nginx安装" class="headerlink" title="Nginx安装"></a>Nginx安装</h1><p>这里以Centos7系统为例，介绍如何在Linux系统上安装Nginx。</p>
<p>第一步，安装相应的依赖。依次执行如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install pcre-devel</span><br><span class="line">yum -y install openssl openssl-devel</span><br></pre></td></tr></table></figure>
<p>第二步，下载Nginx。使用如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://nginx.org/download/nginx-1.17.0.tar.gz</span><br></pre></td></tr></table></figure>
<p>第三步，解压下载的Nginx目录。使用如下所示的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf nginx-1.17.0.tar.gz</span><br></pre></td></tr></table></figure>
<p>之后并进入到该解压后的文件中，依次执行如下命令来编译和安装Nginx：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>之后使用whereis命令可以发现Nginx默认被安装在<code>/usr/local/nginx</code>目录下。</p>
<p>第四步，启动Nginx。进入到<code>/usr/local/nginx/sbin</code>目录下，执行<code>./nginx</code>命令即可启动nginx。</p>
<p>第五步，检查Nginx是否成功启动并访问首页。开发者可以使用如下命令来检查Nginx是否成功启动：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux|grep nginx</span><br></pre></td></tr></table></figure>
<p>之后打开浏览器，在地址栏中输入服务器的IP地址，即可访问到Nginx的首页：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-1ec63edd22e36974.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>这样Nginx就安装并启动成功了，如果修改了Nginx的配置，那么可以使用如下命令来重新加载Nginx：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./nginx -s reload</span><br></pre></td></tr></table></figure>
<p>注意，如果无法访问首页，请检查系统是否开启了防火墙。开发者可以使用如下命令来查看防火墙的状态和一些操作防火墙的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 使用自带命令查看防火墙状态</span><br><span class="line">firewall-cmd --state</span><br><span class="line"># 重启防火墙</span><br><span class="line">firewall-cmd --reload</span><br><span class="line"># 使用systemctl查看防火墙状态</span><br><span class="line">systemctl status firewalld</span><br><span class="line"># 关闭防火墙</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">#开启防火墙</span><br><span class="line">systemctl start firewalld</span><br></pre></td></tr></table></figure>
<p>第六步，设置全局Nginx命令。开发者可以使用<code>vi ~/.bash_profile</code>命令来打开该文件，并在修改其中的PATH代码为如下所示信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PATH=$PATH:$HOME/bin:/usr/local/nginx/sbin/</span><br></pre></td></tr></table></figure>
<p>之后保存并退出，使用<code>source ~/.bash_profile</code>命令来让配置立即生效，这样后续就可以全局使用nginx命令，再也不用进入到<code>/usr/local/nginx/sbin</code>目录了。举个例子，查看nginx的版本，此时就可以使用如下的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@envythink ~]# nginx -v</span><br><span class="line">nginx version: nginx/1.17.0</span><br></pre></td></tr></table></figure>
<p>其实上面那种启动Nginx还是比较复杂的，而且当系统重启后需要开发者进入到<code>/usr/local/nginx/sbin</code>目录下手动启动Nginx，因此最好的办法就是将其添加到开机服务中，使其开机自启动。</p>
<h3 id="Nginx设置开机自启动"><a href="#Nginx设置开机自启动" class="headerlink" title="Nginx设置开机自启动"></a>Nginx设置开机自启动</h3><h5 id="通过nginx-service文件来开机启动"><a href="#通过nginx-service文件来开机启动" class="headerlink" title="通过nginx.service文件来开机启动"></a>通过nginx.service文件来开机启动</h5><p>在<code>/etc/systemd/system/</code>目录下新建一个名为<code>nginx.service</code>的文件，注意名称必须以<code>.service</code>结尾，文件中的内容为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Nginx Server</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/local/nginx/sbin/nginx</span><br><span class="line">ExecReload=/usr/local/nginx/sbin/nginx -s reload</span><br><span class="line">ExecStop=/usr/local/nginx/sbin/nginx -s quit</span><br><span class="line">PrivateTmp=true</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>
<p>简单介绍一下上述参数的各个含义：<br>（1）<code>[Unit]</code>是服务的说明；（2）Description描述服务；（3）After描述服务类别；（4）<code>[Service]</code>服务运行参数的设置；（5）<code>Type=forking</code>表示后台运行；（6）ExecStart为服务的具体运行命令；（7）ExecReload为服务的具体重启命令；（8）ExecStop为服务的具体停止命令；（9）<code>PrivateTmp=True</code>表示给服务分配独立的临时空间；（10）<code>[Install]</code>是运行级别下服务安装的相关设置；（11）<code>WantedBy</code>表示多用户，即系统运行级别为3。</p>
<p>请注意对于<code>[Service]</code>中配置的ExecStart、ExecReload、ExecStop等参数都必须使用绝对路径。开发者可以使用<code>find / -name nginx</code>命令来查询Nginx的位置。</p>
<p>完成上述配置之后，接下来就可以使用<code>systemctl enable nginx.service</code>命令来设置Nginx为开机自启动。</p>
<p>当然还可以借助于systemctl这个Linux系统应用管理工具来对这里添加的Nginx服务进行管理，常用的命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 启动Nginx</span><br><span class="line">systemctl start nginx</span><br><span class="line"># 停止Nginx</span><br><span class="line">systemctl stop nginx</span><br><span class="line"># 重启Nginx</span><br><span class="line">systemctl restart nginx</span><br><span class="line"># 当修改Nginx配置文件时，重新加载Nginx</span><br><span class="line">systemctl reload nginx</span><br><span class="line"># 设置Nginx开机自启动</span><br><span class="line">systemctl enable nginx</span><br><span class="line"># 关闭Nginx开机自启动</span><br><span class="line">systemctl disable nginx</span><br><span class="line"># 查看Nginx运行状态</span><br><span class="line">systemctl status nginx</span><br><span class="line"># 显示启动失败的服务</span><br><span class="line">systemctl --failed</span><br><span class="line"># 查询Nginx是否已经是开机启动</span><br><span class="line">systemctl is-enabled nginx</span><br></pre></td></tr></table></figure>
<h5 id="通过rc-local文件来开机启动"><a href="#通过rc-local文件来开机启动" class="headerlink" title="通过rc.local文件来开机启动"></a>通过rc.local文件来开机启动</h5><p>除了上面的配置nginx.service文件来设置开机启动外，还可以通过rc.local文件来实现。</p>
<p>使用<code>vi /etc/rc.local</code>命令来打开该文件，然后在该文件内添加如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx start</span><br></pre></td></tr></table></figure>
<p>如果开机后发现自启动脚本没有执行，那么需要确认这个rc.local文件是否具有可执行权限，默认情况下是没有可执行权限的。开发者想要修改rc.local文件的权限，可以使用如下的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/rc.d/rc.local</span><br></pre></td></tr></table></figure>
<p>请注意，这里的<code>/etc/rc.local</code>是<code>/etc/rc.d/rc.local</code>文件的软连接，因此需要赋予权限给源文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@envythink ~]# ls -l /etc/rc.local</span><br><span class="line">lrwxrwxrwx. 1 root root 13 10月 10 2019 /etc/rc.local -&gt; rc.d/rc.local</span><br></pre></td></tr></table></figure>
<p>之后重启再次验证，可以发现Nginx开机自启动成功。</p>
<p>尽管上述两种方式都可以设置Nginx的开机自启动，但是在实际工作中笔者更倾向于前者。</p>
<h1 id="Nginx平滑升级"><a href="#Nginx平滑升级" class="headerlink" title="Nginx平滑升级"></a>Nginx平滑升级</h1><p>由于前面我们使用的是源码方式来安装Nginx1.17.0，接下来就介绍如何在此基础上进行平滑升级到1.18.0版本，依次使用如下命令进行升级：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget  http://nginx.org/download/nginx-1.18.0.tar.gz</span><br><span class="line">tar xf nginx-1.18.0.tar.gz -C /home/envythink/soft/</span><br><span class="line">cd /home/envythink/soft/nginx-1.18.0/</span><br><span class="line">./configure --prefix=/usr/local/nginx118 --with-http_stub_status_module --with-http_ssl_module --user=nginx --group=nginx </span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>考虑到后续版本回退的需要，这里将之前的版本进行备份：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/nginx/sbin/nginx /usr/local/nginx/sbin/nginx.bak</span><br></pre></td></tr></table></figure>
<p>接着就可以将新版本的Nginx二进制文件替换为已安装的Nginx二进制文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/nginx116/sbin/nginx /usr/local/nginx/sbin/nginx -rf</span><br></pre></td></tr></table></figure>
<p>之后进入到<code>/usr/local/nginx/sbin</code>目录，使用如下命令验证是否安装成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./nginx -v</span><br></pre></td></tr></table></figure>
<p>可以看到页面输出<code>nginx version: nginx/1.18.0</code>，这就说明已经升级成功了。但是还差最后一步，将Nginx旧的主进程进行停止。首先查看Nginx旧的主进程ID号，然后给它发送一个USR2信号，让新主进程和旧进程同时工作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -USR2 进程PID</span><br></pre></td></tr></table></figure>
<h3 id="Nginx版本回滚"><a href="#Nginx版本回滚" class="headerlink" title="Nginx版本回滚"></a>Nginx版本回滚</h3><p>第一步，使用如下命令将原来的nginx执行脚本进行恢复：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/nginx/sbin/nginx.bak /usr/local/nginx/sbin/nginx -rf</span><br></pre></td></tr></table></figure>
<p>第二步，开发者使用使用如下命令来发送HUP信号来唤醒旧版本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -HUP `cat /usr/local/nginx/logs/nginx.pid.oldbin`</span><br></pre></td></tr></table></figure>
<p>第三步，关闭新版本的主进程和worker进程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kill -USR2 主进程PID</span><br><span class="line">kill -WINCH 主进程PID</span><br></pre></td></tr></table></figure>
<p>第四步，进入到<code>/usr/local/nginx/sbin</code>目录，使用如下命令验证是否安装成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./nginx -v</span><br></pre></td></tr></table></figure>
<p>可以看到页面输出<code>nginx version: nginx/1.17.0</code>，这就说明Nginx版本回滚就已经成功了。</p>
<h1 id="Nginx卸载"><a href="#Nginx卸载" class="headerlink" title="Nginx卸载"></a>Nginx卸载</h1><p>如果开发者是直接通过yum命令安装的Nginx，那么就可以直接使用<code>yum remove nginx</code>命令进行移除。如果是通过上述编译方式进行安装，那么除了需要删除<code>/usr/local/nginx</code>目录外，还需要删除nginx的开机自启动服务。 </p>
<h1 id="Nginx操作常用命令"><a href="#Nginx操作常用命令" class="headerlink" title="Nginx操作常用命令"></a>Nginx操作常用命令</h1><p>前面说过，Nginx默认安装在<code>/usr/local</code>目录下，且其启动程序存在于<code>/usr/local/nginx/sbin</code>目录中，因此可以执行一些Nginx相关的命令，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 向主进程发送信号，重新加载配置文件（热部署）</span><br><span class="line">nginx -s reload</span><br><span class="line"># 重启Nginx</span><br><span class="line">nginx -s restart</span><br><span class="line"># 快速关闭Nginx</span><br><span class="line">nginx -s stop</span><br><span class="line"># 等待工作进程处理完成后才关闭</span><br><span class="line">nginx -s quit</span><br><span class="line"># 查看当前Nginx最终的配置</span><br><span class="line">nginx -T</span><br><span class="line"># 检查配置是否有问题，注意当配置目录存在，那么命令中就不需要存在`-c`</span><br><span class="line">nginx -t -c &lt;配置路径&gt;</span><br></pre></td></tr></table></figure>
<h1 id="Nginx功能模块介绍"><a href="#Nginx功能模块介绍" class="headerlink" title="Nginx功能模块介绍"></a>Nginx功能模块介绍</h1><p>Nginx之所以强大，关键在于它具有很多强大的模块，因此了解和使用这些模块对于提升自己灵活使用Nginx有着非常大的帮助。</p>
<p>Nginx功能模块分为两大类：<strong>“核心功能模块”和“标准的HTTP功能模块”。</strong>其中“核心功能模块”负责Nginx的全局应用，主要对应于主配置文件中的main区块和events区块，这里面有很多Nginx必须的全局配置参数；“标准的HTTP功能模块”，这些虽然不是Nginx软件必须的，但是很常用，因此默认情况下都会自动安装到Nginx软件中。</p>
<p>其实在企业生产环境中，配置、优化和调整都是根据这些模块的功能来修改相应的参数来实现的。下面列举一下Nginx中常用的HTTP功能模块：</p>
<table>
<thead>
<tr>
<th>常用的HTTP功能模块</th>
<th align="center">模块说明</th>
</tr>
</thead>
<tbody><tr>
<td>ngx_http_core_module</td>
<td align="center">包括一些核心的http参数配置，对应Nginx配置文件的HTTP区块部分</td>
</tr>
<tr>
<td>ngx_http_access_module</td>
<td align="center">访问控制模块，用来控制网站用户对nginx的访问</td>
</tr>
<tr>
<td>ngx_http_gzip_module</td>
<td align="center">压缩模块，对nginx返回的数据进行压缩，属于优化性能模块</td>
</tr>
<tr>
<td>ngx_http_fastcgi_module</td>
<td align="center">FastCGI模块，和动态应用相关的模块，例如:PHP</td>
</tr>
<tr>
<td>ngx_http_proxy_module</td>
<td align="center">proxy代理模块</td>
</tr>
<tr>
<td>ngx_http_upstaream_module</td>
<td align="center">负载均衡模块，可以实现网站的负载均衡功能及节点健康检查</td>
</tr>
<tr>
<td>ngx_http_rewrite_module</td>
<td align="center">URL地址重写模块</td>
</tr>
<tr>
<td>ngx_http_limit_conn_module</td>
<td align="center">限制用户并发连接数及请求数模块</td>
</tr>
<tr>
<td>ngx_http_limit_req_module</td>
<td align="center">根据定义的key限制nginx的请求速率</td>
</tr>
<tr>
<td>ngx_http_log_module</td>
<td align="center">访问日志模块，以指定的格式记录nginx的客户端访问日志</td>
</tr>
<tr>
<td>ngx_http_auth_basic_module</td>
<td align="center">Web认证模块，设置web用户通过账号，密码访问nginx</td>
</tr>
<tr>
<td>ngx_http_ssl_module</td>
<td align="center">ssl模块，用于加密http连接</td>
</tr>
<tr>
<td>ngx_http_stub_status_module</td>
<td align="center">记录nginx基本访问状态信息</td>
</tr>
</tbody></table>
<h3 id="Nginx目录结构"><a href="#Nginx目录结构" class="headerlink" title="Nginx目录结构"></a>Nginx目录结构</h3><p>为了更好地学习Nginx，这里有必要对Nginx软件的目录和文件进行一个较为全面的了解，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 如果提示tree命令找不到，可以使用yum -y install tree</span><br><span class="line">[root@envythink vhost]# tree /usr/local/nginx/  </span><br><span class="line">/usr/local/nginx/</span><br><span class="line">├── client_body_temp</span><br><span class="line">├── conf  # nginx配置文件目录，非常重要</span><br><span class="line">│   ├── fastcgi.conf  # fastcgi相关参数配置文件</span><br><span class="line">│   ├── fastcgi.conf.default  # fastcgi.conf文件的原始备份文件，以.default结尾的都是文件的原始备份文件</span><br><span class="line">│   ├── fastcgi_params  # fastcgi的参数文件</span><br><span class="line">│   ├── fastcgi_params.default</span><br><span class="line">│   ├── koi-utf</span><br><span class="line">│   ├── koi-win</span><br><span class="line">│   ├── mime.types # 媒体类型</span><br><span class="line">│   ├── mime.types.default</span><br><span class="line">│   ├── nginx.conf # nginx的主配置文件</span><br><span class="line">│   ├── nginx.conf.default</span><br><span class="line">│   ├── scgi_params</span><br><span class="line">│   ├── scgi_params.default</span><br><span class="line">│   ├── uwsgi_params</span><br><span class="line">│   ├── uwsgi_params.default</span><br><span class="line">│   └── win-utf</span><br><span class="line">├── fastcgi_temp # fastcgi临时数据目录</span><br><span class="line">├── html # 编译安装时的默认站点目录</span><br><span class="line">│   ├── 50x.html # 错误页面优雅显示页面，当出现500/502/503/504等错误时会调用该文件</span><br><span class="line">│   └── index.html # 默认的首页文件，这个文件名也是在nginx.conf中定义好的，一般不需要修改</span><br><span class="line">├── logs  # 这是nginx日志的默认目录，包括访问日志和错误日志</span><br><span class="line">│   ├── access.log  # 访问日志</span><br><span class="line">│   ├── error.log  # 错误日志</span><br><span class="line">│   └── nginx.pid # nginx的pid文件，进程启动后会把pid号写到这个文件中</span><br><span class="line">├── proxy_temp # 临时目录</span><br><span class="line">├── sbin # 这是nginx的命令目录</span><br><span class="line">│   └── nginx # nginx的启动命令nginx脚本</span><br><span class="line">├── scgi_temp # scgi的临时文件</span><br><span class="line">└── uwsgi_temp # uwsgi的临时文件</span><br><span class="line">9 directories, 21 files</span><br></pre></td></tr></table></figure>
<h3 id="nginx-conf主配置文件"><a href="#nginx-conf主配置文件" class="headerlink" title="nginx.conf主配置文件"></a>nginx.conf主配置文件</h3><p>nginx.conf主配置文件非常重要，后期我们绝大部分的配置都在这个文件中进行。开发者可以使用<code>egrep -v &quot;#|^$&quot; /usr/local/nginx/conf/nginx.conf</code>命令来去掉里面的注释，此时它的基本内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    sendfile        on;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于这一部分的学习，会在后面有专门的文件进行介绍，这里就忽略。</p>
<h3 id="fastcgi-conf配置文件"><a href="#fastcgi-conf配置文件" class="headerlink" title="fastcgi.conf配置文件"></a>fastcgi.conf配置文件</h3><p>如果需要Nginx配合动态服务，如PHP等，那么Nginx还会使用到fastcgi相关的配置文件，这个配置是通过在nginx.conf主配置文件中嵌入include命令来实现的，不过前面默认使用了注释，因此不会生效。</p>
<p>fastcgi.conf配置文件中的初始内容如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;</span><br><span class="line">fastcgi_param  QUERY_STRING       $query_string;</span><br><span class="line">fastcgi_param  REQUEST_METHOD     $request_method;</span><br><span class="line">fastcgi_param  CONTENT_TYPE       $content_type;</span><br><span class="line">fastcgi_param  CONTENT_LENGTH     $content_length;</span><br><span class="line"></span><br><span class="line">fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;</span><br><span class="line">fastcgi_param  REQUEST_URI        $request_uri;</span><br><span class="line">fastcgi_param  DOCUMENT_URI       $document_uri;</span><br><span class="line">fastcgi_param  DOCUMENT_ROOT      $document_root;</span><br><span class="line">fastcgi_param  SERVER_PROTOCOL    $server_protocol;</span><br><span class="line">fastcgi_param  REQUEST_SCHEME     $scheme;</span><br><span class="line">fastcgi_param  HTTPS              $https if_not_empty;</span><br><span class="line"></span><br><span class="line">fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;</span><br><span class="line">fastcgi_param  SERVER_SOFTWARE    nginx/$nginx_version;</span><br><span class="line"></span><br><span class="line">fastcgi_param  REMOTE_ADDR        $remote_addr;</span><br><span class="line">fastcgi_param  REMOTE_PORT        $remote_port;</span><br><span class="line">fastcgi_param  SERVER_ADDR        $server_addr;</span><br><span class="line">fastcgi_param  SERVER_PORT        $server_port;</span><br><span class="line">fastcgi_param  SERVER_NAME        $server_name;</span><br><span class="line"></span><br><span class="line"># PHP only, required if PHP was built with --enable-force-cgi-redirect</span><br><span class="line">fastcgi_param  REDIRECT_STATUS    200;</span><br></pre></td></tr></table></figure>
<p>除此之外，还有一个名为fastcgi_params的默认参数配置文件，其中的代码为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">fastcgi_param  QUERY_STRING       $query_string;</span><br><span class="line">fastcgi_param  REQUEST_METHOD     $request_method;</span><br><span class="line">fastcgi_param  CONTENT_TYPE       $content_type;</span><br><span class="line">fastcgi_param  CONTENT_LENGTH     $content_length;</span><br><span class="line"></span><br><span class="line">fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;</span><br><span class="line">fastcgi_param  REQUEST_URI        $request_uri;</span><br><span class="line">fastcgi_param  DOCUMENT_URI       $document_uri;</span><br><span class="line">fastcgi_param  DOCUMENT_ROOT      $document_root;</span><br><span class="line">fastcgi_param  SERVER_PROTOCOL    $server_protocol;</span><br><span class="line">fastcgi_param  REQUEST_SCHEME     $scheme;</span><br><span class="line">fastcgi_param  HTTPS              $https if_not_empty;</span><br><span class="line"></span><br><span class="line">fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;</span><br><span class="line">fastcgi_param  SERVER_SOFTWARE    nginx/$nginx_version;</span><br><span class="line"></span><br><span class="line">fastcgi_param  REMOTE_ADDR        $remote_addr;</span><br><span class="line">fastcgi_param  REMOTE_PORT        $remote_port;</span><br><span class="line">fastcgi_param  SERVER_ADDR        $server_addr;</span><br><span class="line">fastcgi_param  SERVER_PORT        $server_port;</span><br><span class="line">fastcgi_param  SERVER_NAME        $server_name;</span><br><span class="line"></span><br><span class="line"># PHP only, required if PHP was built with --enable-force-cgi-redirect</span><br><span class="line">fastcgi_param  REDIRECT_STATUS    200;</span><br></pre></td></tr></table></figure>
<p>由于fastcgi在实际工作中用的不是很多，因此这里就没有添加中文注释。</p>
<p>好了，那么本篇关于如何在CentOS7上安装Nginx和Nginx功能模块、目录结构和文件的学习就到此为止，后续学习其他的知识。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://envyzhan.asia">余思</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://envyzhan.asia/2020/07/12/nginx-2-nginx-installation-and-function-module-introduction/">http://envyzhan.asia/2020/07/12/nginx-2-nginx-installation-and-function-module-introduction/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://envyzhan.asia" target="_blank">余思博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/nginx/">nginx</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/07/14/nginx-3-nginx-master-profile/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Nginx主配置文件</div></div></a></div><div class="next-post pull-right"><a href="/2020/07/10/nginx-1-introduction/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Nginx简介</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/07/30/nginx-10-security-optimization/" title="Nginx安全优化"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-30</div><div class="title">Nginx安全优化</div></div></a></div><div><a href="/2020/08/01/nginx-11-security-chain-and-crawler-and-virtual-directory/" title="Nginx防盗链、爬虫和虚拟目录"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-01</div><div class="title">Nginx防盗链、爬虫和虚拟目录</div></div></a></div><div><a href="/2020/08/05/nginx-12-file-access-control-and-structure-optimization-and-mobile-adaptation/" title="Nginx文件访问控制、结构优化和适配移动端"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-05</div><div class="title">Nginx文件访问控制、结构优化和适配移动端</div></div></a></div><div><a href="/2020/08/08/nginx-13-nginx-running-state-and-nginx-web-ui/" title="Nginx运行状态和NginxWebUI"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-08</div><div class="title">Nginx运行状态和NginxWebUI</div></div></a></div><div><a href="/2020/08/10/nginx-14-ssl-configuration-and-pan-domain-name-and-static-service/" title="SSL配置、泛域名和静态服务"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-10</div><div class="title">SSL配置、泛域名和静态服务</div></div></a></div><div><a href="/2020/07/16/nginx-4-nginx-virtual-host/" title="Nginx虚拟主机"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-16</div><div class="title">Nginx虚拟主机</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">余思</div><div class="author-info__description">记录成长路上的点滴</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">235</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:envyzhan@aliyun.com" target="_blank" title=""><i class="fa fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎访问啃饼思录！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text">写在前面</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">Nginx安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nginx%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8"><span class="toc-number">2.0.1.</span> <span class="toc-text">Nginx设置开机自启动</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E8%BF%87nginx-service%E6%96%87%E4%BB%B6%E6%9D%A5%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8"><span class="toc-number">2.0.1.0.1.</span> <span class="toc-text">通过nginx.service文件来开机启动</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E8%BF%87rc-local%E6%96%87%E4%BB%B6%E6%9D%A5%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8"><span class="toc-number">2.0.1.0.2.</span> <span class="toc-text">通过rc.local文件来开机启动</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx%E5%B9%B3%E6%BB%91%E5%8D%87%E7%BA%A7"><span class="toc-number">3.</span> <span class="toc-text">Nginx平滑升级</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nginx%E7%89%88%E6%9C%AC%E5%9B%9E%E6%BB%9A"><span class="toc-number">3.0.1.</span> <span class="toc-text">Nginx版本回滚</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx%E5%8D%B8%E8%BD%BD"><span class="toc-number">4.</span> <span class="toc-text">Nginx卸载</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx%E6%93%8D%E4%BD%9C%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">5.</span> <span class="toc-text">Nginx操作常用命令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D"><span class="toc-number">6.</span> <span class="toc-text">Nginx功能模块介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nginx%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">6.0.1.</span> <span class="toc-text">Nginx目录结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nginx-conf%E4%B8%BB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">6.0.2.</span> <span class="toc-text">nginx.conf主配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fastcgi-conf%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">6.0.3.</span> <span class="toc-text">fastcgi.conf配置文件</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/02/15-springboot-integrates-canal-to-realize-data-incremental-synchronization/" title="SpringBoot整合Canal实现数据增量同步"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot整合Canal实现数据增量同步"/></a><div class="content"><a class="title" href="/2022/08/02/15-springboot-integrates-canal-to-realize-data-incremental-synchronization/" title="SpringBoot整合Canal实现数据增量同步">SpringBoot整合Canal实现数据增量同步</a><time datetime="2022-08-02T09:55:30.000Z" title="发表于 2022-08-02 17:55:30">2022-08-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/08/2022-k8s-5-deploy-microservices-on-a-complete-cluster/" title="在完整Kubernetes集群上部署微服务"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="在完整Kubernetes集群上部署微服务"/></a><div class="content"><a class="title" href="/2022/07/08/2022-k8s-5-deploy-microservices-on-a-complete-cluster/" title="在完整Kubernetes集群上部署微服务">在完整Kubernetes集群上部署微服务</a><time datetime="2022-07-08T09:55:30.000Z" title="发表于 2022-07-08 17:55:30">2022-07-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/06/2022-k8s-4-complete-cluster-construction/" title="Kubernetes完整集群搭建"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes完整集群搭建"/></a><div class="content"><a class="title" href="/2022/07/06/2022-k8s-4-complete-cluster-construction/" title="Kubernetes完整集群搭建">Kubernetes完整集群搭建</a><time datetime="2022-07-06T09:55:30.000Z" title="发表于 2022-07-06 17:55:30">2022-07-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/04/2022-k8s-3-simple-environemnt-use/" title="Kubernetes简易环境使用"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes简易环境使用"/></a><div class="content"><a class="title" href="/2022/07/04/2022-k8s-3-simple-environemnt-use/" title="Kubernetes简易环境使用">Kubernetes简易环境使用</a><time datetime="2022-07-04T09:55:30.000Z" title="发表于 2022-07-04 17:55:30">2022-07-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/28/2022-k8s-1-basic-knowledge/" title="Kubernetes基础知识"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes基础知识"/></a><div class="content"><a class="title" href="/2022/06/28/2022-k8s-1-basic-knowledge/" title="Kubernetes基础知识">Kubernetes基础知识</a><time datetime="2022-06-28T09:55:30.000Z" title="发表于 2022-06-28 17:55:30">2022-06-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2022  余思博客,记录成长</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '9996b44b488f2fc52124',
      clientSecret: '6bec0f8e9c032eeae6211a5d4cffa3c97e2d4a64',
      repo: 'blogcomment',
      owner: 'Envythink',
      admin: ['Envythink'],
      id: '0985a88c7df6a6c60166ab44bfbcefec',
      updateCountCallback: commentCount
    },))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div></div></body></html>