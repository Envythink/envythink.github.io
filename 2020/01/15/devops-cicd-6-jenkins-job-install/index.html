<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>CICD平台搭建：Jenkins Job安装 | 余思博客</title><meta name="keywords" content="cicd"><meta name="author" content="余思"><meta name="copyright" content="余思"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="下面是Jenkins的首页，如图所示。接下来介绍Jenkins Job相关的内容。  Jenkins Job介绍Jenkins作为一个持续集成工具，它其实是由若干个Job任务或者Project项目构成了一个庞大的运维开发平台系统。你可以将平时的开发、测试、部署或者基础运维相关的工作任务通过创建一个项目或者任务从而保存在Jenkins任务列表当中，方便你在Jenkins平台下进行日常的开发、运维和维">
<meta property="og:type" content="article">
<meta property="og:title" content="CICD平台搭建：Jenkins Job安装">
<meta property="og:url" content="http://envyzhan.asia/2020/01/15/devops-cicd-6-jenkins-job-install/index.html">
<meta property="og:site_name" content="余思博客">
<meta property="og:description" content="下面是Jenkins的首页，如图所示。接下来介绍Jenkins Job相关的内容。  Jenkins Job介绍Jenkins作为一个持续集成工具，它其实是由若干个Job任务或者Project项目构成了一个庞大的运维开发平台系统。你可以将平时的开发、测试、部署或者基础运维相关的工作任务通过创建一个项目或者任务从而保存在Jenkins任务列表当中，方便你在Jenkins平台下进行日常的开发、运维和维">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png">
<meta property="article:published_time" content="2020-01-15T07:45:10.000Z">
<meta property="article:modified_time" content="2020-11-01T14:42:42.515Z">
<meta property="article:author" content="余思">
<meta property="article:tag" content="cicd">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://envyzhan.asia/2020/01/15/devops-cicd-6-jenkins-job-install/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CICD平台搭建：Jenkins Job安装',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-11-01 22:42:42'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="余思博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">257</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 前端</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/html/"><i class="fa-fw fa fa-cog"></i><span> HTML/CSS</span></a></li><li><a class="site-page child" href="/categories/javascript/"><i class="fa-fw fa fa-cogs"></i><span> JavaScript</span></a></li><li><a class="site-page child" href="/categories/vuejs/"><i class="fa-fw fa fa-certificate"></i><span> Vue.js</span></a></li><li><a class="site-page child" href="/categories/flutter/"><i class="fa-fw fa fa-bullseye"></i><span> Flutter</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> Java</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/java/"><i class="fa-fw fa fa-book"></i><span> Java</span></a></li><li><a class="site-page child" href="/categories/ssm/"><i class="fa-fw fa fa-cube"></i><span> SSM</span></a></li><li><a class="site-page child" href="/categories/springboot/"><i class="fa-fw fa fa-cubes"></i><span> SpringBoot</span></a></li><li><a class="site-page child" href="/categories/springcloud/"><i class="fa-fw fa fa-cloud"></i><span> SpringCloud</span></a></li><li><a class="site-page child" href="/categories/springsecurity/"><i class="fa-fw fa fa-bullseye"></i><span> SpringSecurity</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 运维</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/pythonbase/"><i class="fa-fw fa fa-book"></i><span> Python</span></a></li><li><a class="site-page child" href="/categories/go/"><i class="fa-fw fa fa-google-plus"></i><span> Golang</span></a></li><li><a class="site-page child" href="/categories/devops/"><i class="fa-fw fa fa-road"></i><span> DevOps</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 中间件</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/mysql/"><i class="fa-fw fa fa-database"></i><span> MySQL</span></a></li><li><a class="site-page child" href="/categories/redis/"><i class="fa-fw fa fa-random"></i><span> Redis</span></a></li><li><a class="site-page child" href="/categories/other/"><i class="fa-fw fa fa-location-arrow"></i><span> 其他</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bell"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/datastructs/"><i class="fa-fw fa fa-plug"></i><span> 算法结构</span></a></li><li><a class="site-page child" href="/categories/tools/"><i class="fa-fw fa fa-hourglass"></i><span> 实用工具</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-address-book"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/onenote/"><i class="fa-fw fa fa-laptop"></i><span> 个人随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-comment"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">余思博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 前端</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/html/"><i class="fa-fw fa fa-cog"></i><span> HTML/CSS</span></a></li><li><a class="site-page child" href="/categories/javascript/"><i class="fa-fw fa fa-cogs"></i><span> JavaScript</span></a></li><li><a class="site-page child" href="/categories/vuejs/"><i class="fa-fw fa fa-certificate"></i><span> Vue.js</span></a></li><li><a class="site-page child" href="/categories/flutter/"><i class="fa-fw fa fa-bullseye"></i><span> Flutter</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> Java</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/java/"><i class="fa-fw fa fa-book"></i><span> Java</span></a></li><li><a class="site-page child" href="/categories/ssm/"><i class="fa-fw fa fa-cube"></i><span> SSM</span></a></li><li><a class="site-page child" href="/categories/springboot/"><i class="fa-fw fa fa-cubes"></i><span> SpringBoot</span></a></li><li><a class="site-page child" href="/categories/springcloud/"><i class="fa-fw fa fa-cloud"></i><span> SpringCloud</span></a></li><li><a class="site-page child" href="/categories/springsecurity/"><i class="fa-fw fa fa-bullseye"></i><span> SpringSecurity</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 运维</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/pythonbase/"><i class="fa-fw fa fa-book"></i><span> Python</span></a></li><li><a class="site-page child" href="/categories/go/"><i class="fa-fw fa fa-google-plus"></i><span> Golang</span></a></li><li><a class="site-page child" href="/categories/devops/"><i class="fa-fw fa fa-road"></i><span> DevOps</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 中间件</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/mysql/"><i class="fa-fw fa fa-database"></i><span> MySQL</span></a></li><li><a class="site-page child" href="/categories/redis/"><i class="fa-fw fa fa-random"></i><span> Redis</span></a></li><li><a class="site-page child" href="/categories/other/"><i class="fa-fw fa fa-location-arrow"></i><span> 其他</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bell"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/datastructs/"><i class="fa-fw fa fa-plug"></i><span> 算法结构</span></a></li><li><a class="site-page child" href="/categories/tools/"><i class="fa-fw fa fa-hourglass"></i><span> 实用工具</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-address-book"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/onenote/"><i class="fa-fw fa fa-laptop"></i><span> 个人随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-comment"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CICD平台搭建：Jenkins Job安装</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-01-15T07:45:10.000Z" title="发表于 2020-01-15 15:45:10">2020-01-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-11-01T14:42:42.515Z" title="更新于 2020-11-01 22:42:42">2020-11-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/devops/">devops</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>下面是Jenkins的首页，如图所示。接下来介绍Jenkins Job相关的内容。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-b817dfd53661fb55.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h1 id="Jenkins-Job介绍"><a href="#Jenkins-Job介绍" class="headerlink" title="Jenkins Job介绍"></a>Jenkins Job介绍</h1><p>Jenkins作为一个持续集成工具，它其实是由若干个Job任务或者Project项目构成了一个庞大的运维开发平台系统。你可以将平时的开发、测试、部署或者基础运维相关的工作任务通过创建一个项目或者任务从而保存在Jenkins任务列表当中，方便你在Jenkins平台下进行日常的开发、运维和维护工作。</p>
<p>在Jenkins平台下，我们的工作可以利用Jenkins内建模块或者特定的脚本语法，将我们的工作内容抽象成Jenkins Job（Jenkins任务），然后你可以在这个任务中通过配置相应的参数以及工具模块，从而作为一个可执行的任务，共享保存到Jenkins平台下，供日常工作中不同权限的人员重复build构建执行，这样就将传统的通过单机图形界面或者命令行脚本去配置执行日常任务，迁移到Jenkins这个共享平台下，去进行统一化的任务配置执行，这样就大大的简化了工作流程，方便日常的统一维护工作。</p>
<p>你每一次执行任务的结果记录称之为一个build构建，你可以通过查看这个build构建去获取到我们所需要的结果信息。最终Job任务执行后的build构建信息会保存在Jenkins上，作为build log日志。你可以通过查看不同时间点的log信息，可以去debug追踪任务执行过程中出现的各种问题。Jenkins后台也会通过build log日志的数量和大小，来监控当前Jenkins的健康状况。</p>
<p>Jenkins下所有的任务构建后的所有项目相关文件，例如克隆的仓库代码、Maven打包生成的编译包，你配置的参数文件等，这些都会保存在Jenkins主目录的work space目录下，并以当前任务名称命名的一个目录中，作为当前任务的work space(也就是工作区域进行保存)。你可以通过查看这个工作区域下的相关文件，去获取一些在任务日志中无法定位的问题细节，从而进行问题的深度查找，并解决一些相对困难的问题。</p>
<p>以上就是Jenkins Job任务相关的基础知识，从网上找了一张图片可以了解一下：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-c8eb07633414cad5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h3 id="Freestyle-Job与Pipeline-Job介绍"><a href="#Freestyle-Job与Pipeline-Job介绍" class="headerlink" title="Freestyle Job与Pipeline Job介绍"></a>Freestyle Job与Pipeline Job介绍</h3><p>接下来介绍Jenkins Job两种不同的任务类型，并学会掌握两者直接的区别与不同。</p>
<p><strong>Freestyle Job</strong>是平时用的较为多的任务类型，它是Jenkins发行之初到现在用途最为广泛的任务类型，深受运维、开发、测试人员的广泛青睐。它有以下几个特点：<strong>1、需要在页面添加模块配置项与参数完成配置。</strong>你需要在其任务配置界面添加相应的模块配置项以及任务参数就可以构建一个满足不同工作人员的工作需求。Jenkins会默认在任务配置界面中布局所有模块，以及参数配置项，这样就非常容易地完成了任务的构建工作。<strong>2、每个Job仅能实现一个开发功能。</strong>由于<code>Freestyle Job</code>是Jenkins最早使用的任务类型，它针对开发环境中，不同的任务类型的串联可能会出现一些不足，每个<code>Freestyle Job</code>仅能实现一个任务功能。也就是说你只能在<code>Freestyle Job</code>中干一件事，这样就大大地降低了任务的执行效率。<strong>3、无法将配置代码化，不利于Job配置迁移和版本控制。</strong><code>Freestyle Job</code>的所有配置只能通过前台手动去完成，你无法通过编写代码的方式来完成<code>Freestyle Job</code>的配置工作。这样虽然创建配置很直观，不需要抽象成代码的方式，但是当我们将<code>Freestyle Job</code>进行平行迁移时（其实就是将具体的Job迁移到其他Jenkins系统上）就会变得相对复杂很多。还有一个不足之处在于，默认的Jenkins没有一套完整的审计机制去记录和保存所有人的系统配置历史，也就是说我们无法知道谁曾经动过我的“奶酪”。<strong>4、逻辑相对简单，无需额外学习成本。</strong><code>Freestyle Job</code>虽然有一些不足，但是它的逻辑相对简单，无需额外学习成本，你只需要参照对应的模块文档，就可以在<code>Freestyle Job</code>中找到对应模块的配置项，从而非常轻松的上手，并完成任务配置工作，这也是Jenkins深受新手青睐的一个重要原因。</p>
<hr>
<p><strong>Pipeline Job</strong>是目前推荐，也是业界比较流行的任务类型。<code>Pipeline Job</code>早期是Jenkins的插件，因此早期的<code>Pipeline Job</code>是不能立即使用的，需要你手动安装这个插件才能使用，由于<code>Pipeline Job</code>非常契合持续集成、持续交付、敏捷开发特性，所以越来越多的用户都会将它作为一个首选的Jenkins的插件，作为配置管理Jenkins项目的任务格式，后台Jenkins开发团队也意识到了这一点，已经将<code>Pipeline Job</code>内置了，并成为一种主流。<code>Pipeline Job</code>作为目前Jenkins重要的组成部分，它能够在Jenkins中实现持续集成和持续交付的管道。你可能要问这里的持续集成和持续交付是什么含义呢？它们在Jenkins中起到了什么作用呢？持续集成简称CI，是软件开发周期过程中的一种实践，通过将代码仓库与Jenkins集成，可以使开发人员每一次的代码提交都能够自动在Jenkins上进行任务的build构建，这样就能帮助开发团队第一时间发现问题和解决问题。持续交付简称CD，它是在持续集成CI的基础上，可以将构建好的软件版本通过Jenkins的自动化测试部署等多个程序，持续、安全、快速的交付到用户手中。这里的<code>Pipeline Job</code>就非常满足我们持续集成和持续交付的原则。它也有几个特点：<strong>1、所有模块、参数配置都可以认为是一个Pipeline脚本。</strong>Jenkins下的所有模块、参数配置都可以认为是一个Pipeline脚本，所以你就可以非常方便的调用Pipeline模块去编写业务逻辑。<strong>2、可以定义多个stage构建一个管道工作集。</strong>Jenkins可以通过编写多个stage作为项目集成部署过程中的每一个阶段，构成一整套管道工作集，进而串联所有工作。<strong>3、所有配置代码化，方便Job配置迁移与版本控制。</strong>Pipeline的所有配置最终都可以体现为一段代码，这样就非常方便我们进行Job任务的配置迁移，以及对我们所做的所有改动进行版本控制，将我们项目的所有改动都可以定位到代码层面上，便于后期的审计工作。<strong>4、需要有Pipeline脚本语法基础。</strong>Pipeline虽然有这么多优势，但是作为我们使用者需要去学习Pipeline的基础脚本语法，这使得你需要花费一定的时间去学习，但是当你掌握这个语法后，将会对后期的工作产生巨大的影响。</p>
<p>其实<code>Freestyle Job</code>与<code>Pipeline Job</code>两种任务最大的不同在于<code>Freestyle Job</code>方便配置，但不利于项目管理维护；<code>Pipeline Job</code>方便项目管理，但需要一些学习成本。所以需要结合自身情况来选择适合自己的任务格式。</p>
<h1 id="Jenkins-Job环境配置"><a href="#Jenkins-Job环境配置" class="headerlink" title="Jenkins Job环境配置"></a>Jenkins Job环境配置</h1><p>接下来开始介绍<code>Jenkins Job</code>的环境配置，这个过程相对来说还是比较简单。</p>
<p><strong>第一步，</strong>配置Jenkins server本地Gitlab DNS；你需要明确自己安装部署Gitlab虚拟机的IP，且需要启动该机器。然后在Jenkins所在机器的hosts文件内新增一条指向Gitlab虚拟机的DNS记录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]# vim /etc/hosts</span><br><span class="line"># 文件末尾添加如下一条记录</span><br><span class="line">192.168.2.131    gitlab.example.com</span><br></pre></td></tr></table></figure>

<p><strong>第二步，</strong>安装git client，curl工具依赖，你可以使用<code>yum install -y git curl</code>命令来进行安装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]# yum install -y git curl</span><br></pre></td></tr></table></figure>

<p><strong>第三步，</strong>关闭系统Git http.sslVerify安全认证，你可以使用<code>git config --system http.sslVerify false</code>命令来关闭，同时可以使用<code>echo $?</code>来验证是否成功关闭：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]# git config --system http.sslVerify false</span><br><span class="line">[root@jenkins ~]# echo $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<p><strong>第四步，</strong>添加Jenkins后台Git client的user和email：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-d371aee1a9685d3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-cffb23f297f30018.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><strong>第五步，</strong>添加Jenkins后台Git Credential依据：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-c2413a3cb61c5636.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-4095060e57fcf905.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-23dcad2cc668d721.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-ed4ebaa6d29ca863.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>请注意上面必须是passworld类型，点击确定，之后出现下面的界面表示你已经成功添加了git的凭据：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-c93586c075c7cc59.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h1 id="Jenkins-Freestyle-Job构建配置"><a href="#Jenkins-Freestyle-Job构建配置" class="headerlink" title="Jenkins Freestyle Job构建配置"></a>Jenkins Freestyle Job构建配置</h1><p><strong>第一步，</strong>创建一个Freestyle Project，名称为<code>test-freestyle-job</code>，选择Freestyle Project格式：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-d25f37ca325b2d00.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-74272326456a2d14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><strong>第二步，</strong>编辑描述信息，完成第一步后页面会跳转到下面所示界面：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-724d2b0fb6a2f7be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>接着在描述那一栏填写：this is my first test frestyle job.。接着点击下方的<code>This project is parameterized</code>（参数化构建过程）。然后下拉菜单，首先选择<code>Choice Parameter</code>选项参数：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-f98194d41bfd3600.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>然后在里面填写build时的选项参数信息，具体包括名称、选项和描述：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-335aa956756ff923.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>之后点击添加参数，选择<code>String Parameter</code>文本参数：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-6c2b7863cc0ee316.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-cf9a65591cec88dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><strong>第三步，</strong>配置gitlab参数，首先需要运行gitlab所在的虚拟机，并使用<code>gitlab-ctl start</code>命令来启动gitlab服务，其次选择first-repo项目，并粘贴该项目的SSH克隆地址：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-b54070c77439f318.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>接着回到Jenkins的test-freestyle-job任务，选择git管理，然后按照下图进行操作：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-c282cf96b938bad3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><strong>第四步，</strong>添加build，其实就是你需要执行的信息：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-9983ecb1db3a4b46.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>然后在命令选项框内输入以下信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">export PATH=&quot;/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin&quot;</span><br><span class="line"></span><br><span class="line"># Print env variable</span><br><span class="line">echo &quot;[INFO] Print env variable&quot;</span><br><span class="line">echo &quot;Current deployment envrionment is $deploy_env&quot; &gt;&gt; test.properties</span><br><span class="line">echo &quot;THe build is $version&quot; &gt;&gt; test.properties</span><br><span class="line">echo &quot;[INFO] Done...&quot;</span><br><span class="line"></span><br><span class="line"># Check test properties</span><br><span class="line">echo &quot;[INFO] Check test properties&quot;</span><br><span class="line">if [ -s test.properties ]</span><br><span class="line">then</span><br><span class="line">  cat test.properties</span><br><span class="line">  echo &quot;[INFO] Done...&quot;</span><br><span class="line">else</span><br><span class="line">  echo &quot;test.properties is empty&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;[INFO] Build finished...&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/8964398-5dded9d572a7e2ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>然后点击应用和保存按钮，页面会自动退出当前的build界面。</p>
<p><strong>第五步，</strong>点击“Build with Parameters”，开始运行任务：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-650c30fbdd104abb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>之后会进入构建前的参数选择界面，前面设置了选项参数，这里选择dev，下面的version是文本参数，默认为你前面设置的1.0.0，当然你可以自己修改：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-ecc4af4d98d57dac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>然后点击下方的“开始构建按钮”按钮：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-d61763a4c50da2a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>可以发现页面的左下方就多了一个任务构建的进度条，将鼠标放上去：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-faf9fcab44534d43.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>说明项目已经构建完成了，然后点击那个小圆球，可以看到右侧已经成功输出了执行结果：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-a7987878139fb26d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h3 id="Jenkins-Pipeline-Job介绍"><a href="#Jenkins-Pipeline-Job介绍" class="headerlink" title="Jenkins Pipeline Job介绍"></a>Jenkins Pipeline Job介绍</h3><p>作为Jenkins目前主推的任务构建模式Pipeline Job，它的管道块连接子任务的主体架构逻辑已经被广泛的运用在大中小型项目部署、交付构建当中。这里推荐有项目经验的人通过本篇的学习，尝试将自己的项目迁移到更加容易维护管理的Pipeline Job任务模式下。接下来介绍Pipeline Job的编写规范。</p>
<h1 id="Pipeline简介"><a href="#Pipeline简介" class="headerlink" title="Pipeline简介"></a>Pipeline简介</h1><h3 id="Pipeline基础架构"><a href="#Pipeline基础架构" class="headerlink" title="Pipeline基础架构"></a>Pipeline基础架构</h3><p><strong>1.所有代码包裹在pipeline{}层内</strong>；<br><strong>2.stages{}层用来包含该pipeline所有stage子层。</strong>它用来将Pipeline管道分为若干个管道块，每一个管道块可以做一件事情，且彼此之间不受任何影响；<br><strong>3.stage{}层用来包含具体我们需要编写任务的steps{}子层。</strong>stage后面跟管道名称，这里的一个stage就是一个个的管道块，你可以在里面添加需要编写任务的steps{}子层；<br><strong>4.steps{}用来添加我们具体需要调用的模块语句。</strong>如sh，echo等。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-3db3992ce03632e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h3 id="agent区域"><a href="#agent区域" class="headerlink" title="agent区域"></a>agent区域</h3><p>agent定义pipeline在哪里运行，可以使用any，none，或具体的Jenkins node主机名等。举个例子来说，如果我们要在node1主机上执行，那么可以写成：<code>agent&#123;node1 &#123;label &#39;node1&#39;&#125;&#125;</code>，但是并不推荐新手这么操作，新手还是使用any为好，这样会随机在一台Jenkins主机上执行构建：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-b2bdf81cfd68623c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h3 id="environment区域"><a href="#environment区域" class="headerlink" title="environment区域"></a>environment区域</h3><p>environment区域用来定义当前Pipeline任务的系统环境变量的配置。你可以使用<code>“变量名称=变量值”</code>的形式来定义我们的环境变量；同时你可以定义全局环境变量，它应用所有stage任务。也可以定义stage环境变量，应用于单独的stage任务：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-204bd838b209722d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h3 id="script区域（可选）"><a href="#script区域（可选）" class="headerlink" title="script区域（可选）"></a>script区域（可选）</h3><p>script区域是可选的，它定义在steps区域下（通常为script{}），可以编写groovy脚本语言，用来进行脚本逻辑运算：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-fefa948ffcbfda01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h3 id="常用steps区域"><a href="#常用steps区域" class="headerlink" title="常用steps区域"></a>常用steps区域</h3><p>我们大部分的模块调用或者逻辑语法编写都是在这个区域中展开。你可以使用<code>echo</code>来打印输出静态或者动态语句，到我们build构建任务log输出内。也可以使用<code>sh</code>来调用Linux系统的shell命令，去在Pipeline下编写shell脚本。还可以使用<code>git url</code>来调用git的相关模块进行git操作：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-22f2abaea9029259.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h1 id="Jenkins-Pipeline-Job构建配置"><a href="#Jenkins-Pipeline-Job构建配置" class="headerlink" title="Jenkins Pipeline Job构建配置"></a>Jenkins Pipeline Job构建配置</h1><p><strong>第一步，</strong>创建一个Pipeline Project，名称为<code>test-pipeline-job</code>，选择流水线格式：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-061a602e7cca3c49.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><strong>第二步，</strong>编辑描述信息，完成第一步后页面会跳转到下面所示界面：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-5d33e3207638d058.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>接着在描述那一栏填写：this is my first test pipeline job.：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-66baec492785e8fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><strong>第三步，</strong>pipeline脚本配置。首先获取当前Jenkins节点的唯一标识Id：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-0524175d9c9f959e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>然后编写pipeline脚本，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">#!groovy</span><br><span class="line"></span><br><span class="line">pipeline &#123;</span><br><span class="line">    agent &#123;node &#123;label &#x27;master&#x27;&#125;&#125;</span><br><span class="line"></span><br><span class="line">    environment &#123;</span><br><span class="line">        PATH=&quot;/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    parameters &#123;</span><br><span class="line">        choice(</span><br><span class="line">            choices: &#x27;dev\nprod&#x27;,</span><br><span class="line">            description: &#x27;choose deploy environment&#x27;,</span><br><span class="line">            name: &#x27;deploy_env&#x27;</span><br><span class="line">            )</span><br><span class="line">        string (name: &#x27;version&#x27;, defaultValue: &#x27;1.0.0&#x27;, description: &#x27;build version&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&quot;Checkout test repo&quot;) &#123;</span><br><span class="line">            steps&#123;</span><br><span class="line">                sh &#x27;git config --global http.sslVerify false&#x27;</span><br><span class="line">                dir (&quot;$&#123;env.WORKSPACE&#125;&quot;) &#123;</span><br><span class="line">                    git branch: &#x27;master&#x27;, credentialsId:&quot;957f4bef-6d33-416d-a28e-1d489a7905a8&quot;, url: &#x27;https://gitlab.example.com/root/first-repo.git&#x27;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&quot;Print env variable&quot;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                dir (&quot;$&#123;env.WORKSPACE&#125;&quot;) &#123;</span><br><span class="line">                    sh &quot;&quot;&quot;</span><br><span class="line">                    echo &quot;[INFO] Print env variable&quot;</span><br><span class="line">                    echo &quot;Current deployment environment is $deploy_env&quot; &gt;&gt; test.properties</span><br><span class="line">                    echo &quot;The build is $version&quot; &gt;&gt; test.properties</span><br><span class="line">                    echo &quot;[INFO] Done...&quot;</span><br><span class="line">                    &quot;&quot;&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&quot;Check test properties&quot;) &#123;</span><br><span class="line">            steps&#123;</span><br><span class="line">                dir (&quot;$&#123;env.WORKSPACE&#125;&quot;) &#123;</span><br><span class="line">                    sh &quot;&quot;&quot;</span><br><span class="line">                    echo &quot;[INFO] Check test properties&quot;</span><br><span class="line">                    if [ -s test.properties ]</span><br><span class="line">                    then </span><br><span class="line">                        cat test.properties</span><br><span class="line">                        echo &quot;[INFO] Done...&quot;</span><br><span class="line">                    else</span><br><span class="line">                        echo &quot;test.properties is empty&quot;</span><br><span class="line">                    fi</span><br><span class="line">                    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">                    echo &quot;[INFO] Build finished...&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>请注意需要将credentialsId替换为刚才自己获取的credentialsId，以及url为自己待克隆的项目地址，如<code>https://gitlab.example.com/root/first-repo.git</code>。该代码其实和freestyle job表达的意思完全一样，首先是设置当前为哪种环境，其次是当前build版本信息。第一个stage任务（Checkout test repo）的意思是从gitlab仓库拉取仓库代码到Jenkins当前Job的workspace下，下载下来的代码中包含我们的<code>test.properties</code>文件，因此你需要提前去你gitlab仓库的<code>test-repo</code>项目中新建一个空白的<code>test.properties</code>文件：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-fdf4abc540c32477.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>第二个stage任务（Print env variable）的意思是打印输出之前配置的环境参数，并将其写入到<code>test.properties</code>文件中。第三个stage任务（Check test properties）的意思是检查<code>test.properties</code>文件是否存在。</p>
<p>然后将前面编写的pipeline脚本拷贝进去：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-1690941909123db2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-cc71e9ff8354a481.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>可以发现构建出错了：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-2c1afedc8c670f11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>查看日志，可以发现问题：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-1aed69a4f93fe0af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>错误提示为：没有找到对应参数的变量。那是因为首次构建pipeline job时，参数没有被引用到当前pipeline job当中，你需要返回<code>test-pipeline-job</code>的主界面，此时的“立即构建”按钮会变为“Build with Parameters”，然后点击“Build with Parameters”：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-c081786a1b01e715.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>使用默认的参数，点击下方的开始构建：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-d8d61c2fc1ce96c5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>当看到下面的结果时，表明已经执行成功了：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-e75641edff474403.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>你还可以点击左侧的蓝色小圆球，查看输出日志信息：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/8964398-3c6bd074b90beb4e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p><code>Running on Jenkins in /var/lib/jenkins/workspace/test-pipeline-job</code>表示你所有的信息都会存到<code>/var/lib/jenkins/workspace/test-pipeline-job</code>目录下。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://envyzhan.asia">余思</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://envyzhan.asia/2020/01/15/devops-cicd-6-jenkins-job-install/">http://envyzhan.asia/2020/01/15/devops-cicd-6-jenkins-job-install/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://envyzhan.asia" target="_blank">余思博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/cicd/">cicd</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/01/16/devops-cicd-7-jenkins-used/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CICD平台搭建：Jenkins应用</div></div></a></div><div class="next-post pull-right"><a href="/2020/01/13/devops-cicd-5-jenkins-install/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CICD平台搭建：Jenkins安装</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/01/07/devops-cicd-2-gitlab-used/" title="CICD平台搭建：Gitlab应用"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-07</div><div class="title">CICD平台搭建：Gitlab应用</div></div></a></div><div><a href="/2020/01/16/devops-cicd-7-jenkins-used/" title="CICD平台搭建：Jenkins应用"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-16</div><div class="title">CICD平台搭建：Jenkins应用</div></div></a></div><div><a href="/2020/01/05/devops-cicd-1-gitlab-install/" title="CICD平台搭建：Gitlab安装"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-05</div><div class="title">CICD平台搭建：Gitlab安装</div></div></a></div><div><a href="/2020/01/09/devops-cicd-3-ansible-install/" title="CICD平台搭建：Ansible安装"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-09</div><div class="title">CICD平台搭建：Ansible安装</div></div></a></div><div><a href="/2020/01/13/devops-cicd-5-jenkins-install/" title="CICD平台搭建：Jenkins安装"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-13</div><div class="title">CICD平台搭建：Jenkins安装</div></div></a></div><div><a href="/2020/01/11/devops-cicd-4-ansbile-playbook-introdution/" title="CICD平台搭建：Ansible playbooks介绍"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-11</div><div class="title">CICD平台搭建：Ansible playbooks介绍</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">余思</div><div class="author-info__description">记录成长路上的点滴</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">257</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:envyzhan@aliyun.com" target="_blank" title=""><i class="fa fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎访问余思博客，一个技术博主的成长试验田！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Jenkins-Job%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">Jenkins Job介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Freestyle-Job%E4%B8%8EPipeline-Job%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.0.1.</span> <span class="toc-text">Freestyle Job与Pipeline Job介绍</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Jenkins-Job%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">Jenkins Job环境配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Jenkins-Freestyle-Job%E6%9E%84%E5%BB%BA%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">Jenkins Freestyle Job构建配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins-Pipeline-Job%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.0.1.</span> <span class="toc-text">Jenkins Pipeline Job介绍</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pipeline%E7%AE%80%E4%BB%8B"><span class="toc-number">4.</span> <span class="toc-text">Pipeline简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pipeline%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84"><span class="toc-number">4.0.1.</span> <span class="toc-text">Pipeline基础架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#agent%E5%8C%BA%E5%9F%9F"><span class="toc-number">4.0.2.</span> <span class="toc-text">agent区域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#environment%E5%8C%BA%E5%9F%9F"><span class="toc-number">4.0.3.</span> <span class="toc-text">environment区域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#script%E5%8C%BA%E5%9F%9F%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="toc-number">4.0.4.</span> <span class="toc-text">script区域（可选）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8steps%E5%8C%BA%E5%9F%9F"><span class="toc-number">4.0.5.</span> <span class="toc-text">常用steps区域</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Jenkins-Pipeline-Job%E6%9E%84%E5%BB%BA%E9%85%8D%E7%BD%AE"><span class="toc-number">5.</span> <span class="toc-text">Jenkins Pipeline Job构建配置</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/04/27/2024-6-mult-tenant-architecture-design-and-practice/" title="多租户架构设计与实践"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多租户架构设计与实践"/></a><div class="content"><a class="title" href="/2024/04/27/2024-6-mult-tenant-architecture-design-and-practice/" title="多租户架构设计与实践">多租户架构设计与实践</a><time datetime="2024-04-27T11:55:30.000Z" title="发表于 2024-04-27 19:55:30">2024-04-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/23/2024-3-detailed-explanation-of-json-data-types-in-mysql/" title="详解MySQL中的JSON数据类型"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="详解MySQL中的JSON数据类型"/></a><div class="content"><a class="title" href="/2024/03/23/2024-3-detailed-explanation-of-json-data-types-in-mysql/" title="详解MySQL中的JSON数据类型">详解MySQL中的JSON数据类型</a><time datetime="2024-03-23T10:55:30.000Z" title="发表于 2024-03-23 18:55:30">2024-03-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/02/2024-2-six-common-configuration-methods-for-reading-properties/" title="聊一聊六种常用的属性配置读取方式"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="聊一聊六种常用的属性配置读取方式"/></a><div class="content"><a class="title" href="/2024/03/02/2024-2-six-common-configuration-methods-for-reading-properties/" title="聊一聊六种常用的属性配置读取方式">聊一聊六种常用的属性配置读取方式</a><time datetime="2024-03-02T02:55:30.000Z" title="发表于 2024-03-02 10:55:30">2024-03-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/03/2024-1-nine-commonly-used-distributed-id-generation-schemes/" title="聊一聊九种常用的分布式ID生成方案"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="聊一聊九种常用的分布式ID生成方案"/></a><div class="content"><a class="title" href="/2024/02/03/2024-1-nine-commonly-used-distributed-id-generation-schemes/" title="聊一聊九种常用的分布式ID生成方案">聊一聊九种常用的分布式ID生成方案</a><time datetime="2024-02-03T06:55:27.000Z" title="发表于 2024-02-03 14:55:27">2024-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/28/2023-104-cleverly-using-paginated-list-caching-to-quickly-respond-to-user-requests/" title="巧用分页列表缓存，快速响应用户请求"><img src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="巧用分页列表缓存，快速响应用户请求"/></a><div class="content"><a class="title" href="/2023/05/28/2023-104-cleverly-using-paginated-list-caching-to-quickly-respond-to-user-requests/" title="巧用分页列表缓存，快速响应用户请求">巧用分页列表缓存，快速响应用户请求</a><time datetime="2023-05-28T08:55:30.000Z" title="发表于 2023-05-28 16:55:30">2023-05-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2024  余思博客,记录成长</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '9996b44b488f2fc52124',
      clientSecret: '6bec0f8e9c032eeae6211a5d4cffa3c97e2d4a64',
      repo: 'blogcomment',
      owner: 'Envythink',
      admin: ['Envythink'],
      id: '18f53b593de51eda9006ce988ad1eaea',
      updateCountCallback: commentCount
    },))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div></div></body></html>